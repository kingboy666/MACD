# MACD 智能交易机器人

## 项目简介
基于 MACD(6,32,9) 策略的智能加密货币交易机器人，具备 ATR 动态止盈止损、智能杠杆分配和多仓位管理功能。

## 核心功能

### 📈 交易策略
- **MACD(6,32,9)** 技术指标
- **ADX** 趋势强度识别
- **30分钟** 时间框架
- 金叉做多，死叉平仓（做空相反）

### 🛡️ 风险管理
- **ATR 动态止盈止损**
  - 止损倍数：2.0x ATR
  - 止盈倍数：3.0x ATR
  - 利润保护机制
- **移动止盈**：保护已实现利润
- **智能仓位分配**：使用余额80%

### ⚡ 智能杠杆系统
- **BTC**：最大100倍杠杆，最低20倍
- **ETH**：最大50倍杠杆，最低20倍
- **主流币**：最大30倍杠杆，最低20倍
- **其他币种**：最大25倍杠杆，最低20倍
- 根据账户大小和波动性智能调节

### 💰 资金管理
- 使用账户余额的80%进行交易
- **无最小金额限制**：支持0.1U小额交易
- 智能多仓位资金分配
- 统一管理交易所现有持仓

## 技术特性

### 🔧 核心组件
- **实时K线数据获取**
- **技术指标计算**（MACD、ADX、ATR）
- **条件单管理**
- **动态止损调整**
- **多线程安全**

### 🌐 交易所支持
- 支持 CCXT 兼容的主流交易所
- 自动同步现有持仓
- 完整的API错误处理

## 部署说明

### Railway 部署
1. Fork 本仓库
2. 连接到 Railway
3. 设置环境变量：
   - `API_KEY`: 交易所API密钥
   - `SECRET_KEY`: 交易所密钥
   - `PASSPHRASE`: API密码（如需要）
4. 部署运行

### 本地运行
```bash
# 安装依赖
pip install -r requirements.txt

# 运行机器人
python main.py
```

## 环境变量配置

```env
# 交易所API配置
API_KEY=your_api_key
SECRET_KEY=your_secret_key
PASSPHRASE=your_passphrase

# 可选配置
SYMBOLS=BTC-USDT,ETH-USDT  # 交易对
MAX_POSITIONS=5            # 最大持仓数
```

## 安全特性

- ✅ 完整的错误处理和重试机制
- ✅ 资金安全保护
- ✅ API密钥安全存储
- ✅ 实时风险监控
- ✅ 详细的交易日志

## 注意事项

⚠️ **风险提示**：
- 加密货币交易存在高风险，可能导致资金损失
- 请在充分了解风险的情况下使用
- 建议先在测试环境中运行
- 不构成投资建议

## 更新日志

### v2.0.0
- ✨ 新增 ATR 动态止盈止损系统
- ✨ 智能杠杆分配功能
- ✨ 多仓位资金管理
- ✨ 交易所持仓同步
- 🐛 修复语法和缩进问题
- 🚀 支持 Railway 一键部署

## 许可证
MIT License

## 联系方式
如有问题或建议，请提交 Issue 或 Pull Request。